# Spring web application

`spring-boot-starter-web`

## Spring MVC

ì›¹ í”„ë ˆì„ì›Œí¬
- Model + View + Controller íŒ¨í„´
- POJO í”„ë¡œê·¸ë˜ë°
  - POJO (plain old Java object) : íŠ¹ì • í”„ë ˆì„ì›Œí¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ â†’ ì½”ë“œ ì¬ì‚¬ìš©ì„± ë†’ìŒ
- í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ì„¤ê³„

> Spring BootëŠ” Spring MVCë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ ë•ëŠ”ë‹¤. (ex. auto configuration, ë‚´ì¥ ì„œë²„, ì˜ì¡´ì„± ê´€ë¦¬)

### types

- web servlet
  - ì „í†µì  (Java EE servlet ê¸°ë°˜)
  - servlets : HTTP ìš”ì²­â€¢ì‘ë‹µ ì²˜ë¦¬
  - filters : ìš”ì²­â€¢ì‘ë‹µì„ ê°€ë¡œì±„ì„œ ì¶”ê°€ì ì¸ ì²˜ë¦¬ (ex. ì¸ì¦, ë¡œê¹…, ì••ì¶•)
  - listeners : íŠ¹ì • servlet container ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì‹¤í–‰
    - `HttpSessionListener`, `ServletContextListener`
- web reactive
  - ìµœì‹  ê°œë°œ ë°©ì‹
  - ë†’ì€ íš¨ìœ¨ì„± â†’ ëŒ€ëŸ‰ì˜ ìš”ì²­ ë™ì‹œ ì²˜ë¦¬
  - ë¹„ë™ê¸° â†’ ìì› íš¨ìœ¨ì  ì‚¬ìš© + ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„

### web servlet components

![web-servlet-components](./images/04-1.png)

- locale resolver : ì‚¬ìš©ì ë¡œì¼€ì¼ ê²°ì • â†’ ë‹¤êµ­ì–´ ì§€ì›
- exception resolver : ìš”ì²­ ì²˜ë¦¬ ì¤‘ ë°œìƒí•˜ëŠ” ì˜ˆì™¸ ì²˜ë¦¬
- view resolver : controllerê°€ ë°˜í™˜í•œ view ì´ë¦„ â†’ ì‹¤ì œ viewë¡œ ë³€í™˜
- dispatcher servlet : ëª¨ë“  ìš”ì²­ì„ ë°›ì•„ì„œ ì ì ˆí•œ handlerë¡œ ì „ë‹¬
- handler mapping : ìš”ì²­ URL â†’ ì ì ˆí•œ handler(= controller)ë¡œ ë§¤í•‘
- handler adapter : ë‹¤ì–‘í•œ handler ì§€ì›
- controller : ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ + ì ì ˆí•œ ì‘ë‹µ ìƒì„±
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰ í›„ view ë°˜í™˜
- message converter : ìš”ì²­/ì‘ë‹µ í˜•ì‹ â†’ íŠ¹ì • í˜•ì‹ìœ¼ë¡œ ë³€í™˜
- content type manager : ì½˜í…ì¸  íƒ€ì… ê´€ë¦¬

> ğŸ’¡ ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ ìˆœì„œ
> 1. dispatcher servletì´ ì‚¬ìš©ì ìš”ì²­ì„ ë°›ëŠ”ë‹¤.
> 2. dispatcher servletì€ handler mappingì„ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ URLì„ ì ì ˆí•œ controllerë¡œ ë§¤í•‘í•œë‹¤.
> 3. ë§¤í•‘ëœ handlerë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ handler adapterë¥¼ ê±°ì¹œë‹¤.
> 4. controllerëŠ” ì‚¬ìš©ì ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•œ í›„ dispatcher servletì—ê²Œ ë…¼ë¦¬ì ì¸ view ì´ë¦„ì´ë‚˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.
> 5. view resolverëŠ” controllerê°€ ë°˜í™˜í•œ view ì´ë¦„ì„ ì‹¤ì œ viewë¡œ ë³€í™˜í•˜ì—¬ dispatcher servletì—ê²Œ ë°˜í™˜í•œë‹¤.
> 6. dispatcher servletì€ ìµœì¢… ì‘ë‹µì„ ì‚¬ìš©ìì—ê²Œ ë°˜í™˜í•œë‹¤.

#### how to generate response data

message converter : Java ê°ì²´ â†’ í…ìŠ¤íŠ¸ í˜•ì‹
  - Spring MVCì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥
  - ê°œë°œìëŠ” Java ê°ì²´ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ ì‘ì—… ê°€ëŠ¥ (ìˆ˜ë™ ë³€í™˜ X)
  - `@ResponseBody` : Java ê°ì²´ê°€ message converterë¥¼ í†µí•´ ìë™ìœ¼ë¡œ ë³€í™˜ë˜ì–´ HTTP ì‘ë‹µì— í¬í•¨ë¨
    - HTTP ìš”ì²­ì˜ `Accept` í—¤ë”ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì ì ˆí•œ message converter ì„ íƒ

<br />

# controller

```java
@Controller
public class MemberController {
  
  @GetMapping("/members")
  @ResponseBody
  public List<Member> findAll() { ... }
  ...
}
```

- `@Controller`
- `@ResponseBody` : REST ì‘ë‹µ
  - ë©”ì„œë“œê°€ ë°˜í™˜í•˜ëŠ” ì‘ë‹µì„ HTTP ì‘ë‹µ ë³¸ë¬¸ì— ì§ì ‘ ì”€ = ë°˜í™˜ê°’ì„ view ì´ë¦„ìœ¼ë¡œ í•´ì„í•˜ì§€ ì•ŠìŒ
  - ì£¼ë¡œ JSONâ€¢XML í˜•ì‹ ì‚¬ìš©
  - `@RestController` = `@Controller` + `@ResponseBody`

> controllerì˜ ëª¨ë“  ë©”ì†Œë“œì— ë™ì¼í•œ ê¸°ë³¸ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•ŒëŠ” `@RequestMapping`ì„ ì‚¬ìš©í•œë‹¤.
> ```java
> @RestController
> @RequestMapping("/members")
> public class MemberController { ... }
> ```

> Springì€ ì‚¬ìš©ì ìš”ì²­ì„ ë¶„ì„í•˜ì—¬ ìë™ìœ¼ë¡œ ë©”ì†Œë“œ ì¸ìë¥¼ ì£¼ì…í•œë‹¤.
> ```java
> @GetMapping("/search")
> public List<Member> findAllByKeyword(@RequestParam String keyword) { ... }
> 
> @GetMapping("/{id}")
> public Optional<Member> findById(@PathVariable Long id) { ... }
> 
> @PostMapping
> public Member createMember(@RequestBody Member member) { ... }
> ```
> - `@RequestParam(required=[BOOLEAN])`ì„ í†µí•´ í•„ìˆ˜ ì—¬ë¶€ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. (ê¸°ë³¸ê°’ì€ `required=true`)
>   - `defaultValue`ë¥¼ ì„¤ì •í•˜ì—¬ íŒŒë¼ë¯¸í„°ê°€ ì—†ì„ ë•Œ ì‚¬ìš©í•  ê¸°ë³¸ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
> - ë©”ì†Œë“œ ì¸ìì˜ ì´ë¦„ì€ íŒŒë¼ë¯¸í„° ë³€ìˆ˜ëª…, ê²½ë¡œ ë³€ìˆ˜ëª…ê³¼ ì¼ì¹˜í•´ì•¼ í•œë‹¤. ë‹¤ë¥¸ ê²½ìš°ì—ëŠ” `name=[NAME]`ìœ¼ë¡œ ëª…ì‹œì ìœ¼ë¡œ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.
> - ì´ì™¸ì—ë„ `HttpServletRequest`, `Session`, `Principal` ë“±ì´ ìˆë‹¤.

> ğŸ’¡ Spring Boot DevTools : ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë” ë¹ ë¥´ê³  í¸ë¦¬í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•œ ë„êµ¬ ëª¨ìŒ
> - ìë™ ì¬ì‹œì‘ : ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ì¬ì‹œì‘ (nodemonê³¼ ìœ ì‚¬!)
> - ê°œë°œ ì „ìš© ì„¤ì • `developmentOnly` : í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ìë™ìœ¼ë¡œ ë¹„í™œì„±í™”
> ```groovy
> dependencies {
>   developmentOnly 'org.springframework.boot:spring-boot-devtools'
> }
> ```